#!/bin/sh
set -e

echo "Running pre-commit checks..."

echo "Checking Markdown formatting..."
if command -v dprint >/dev/null 2>&1; then
  dprint check --staged --allow-no-files
else
  echo "dprint is required. Install it with one of:"
  echo "  cargo install dprint"
  echo "  brew install dprint"
  exit 1
fi

echo "Checking Rust formatting..."
cargo fmt --all -- --check

echo "Running clippy..."
# Note: Using default features only. Platform-specific features (cuda, metal)
# require specific hardware/compilers and are validated in CI.
cargo clippy --all-targets -- -D warnings

echo "All checks passed!"
