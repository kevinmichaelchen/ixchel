---
title: adr-search
description: Semantic search over Architecture Decision Records
---

# adr-search

Semantic search over Architecture Decision Records, backed by embedded HelixDB.

**Status:** Scaffolded

## Why adr-search?

Agents need quick access to architectural decisions for context:

- "What have we decided about caching?"
- "Why did we choose X over Y?"
- "Are we already committed to this direction?"

But `.decisions/` directories are unindexed markdown. adr-search makes them **searchable in < 100ms** via semantic indexing.

## Installation

```bash
cargo install --path adr-search
```

## Usage

```bash
# Search ADRs (default: .decisions/)
adr-search <QUERY> [OPTIONS]

# Examples
adr-search "caching"
adr-search "database migration" --status accepted
adr-search "API design" --limit 5 --json
```

### Options

| Option | Description | Default |
|--------|-------------|---------|
| `-d, --directory` | ADR directory | `.decisions/` |
| `-l, --limit` | Max results | 10 |
| `--status` | Filter by status | all |
| `--tags` | Filter by tags (comma-separated) | all |
| `-j, --json` | JSON output | false |

## Output Formats

### Pretty (human-readable)

```
[1] ADR-003: Database Migration Strategy
    Status: accepted
    Score: 0.89
    Tags: database, migration, infrastructure

[2] ADR-001: Schema Versioning Approach
    Status: proposed
    Score: 0.71
    Tags: database, schema, testing
```

### JSON (machine-readable)

```json
{
  "query": "database migration",
  "results": [
    {
      "id": 3,
      "title": "Database Migration Strategy",
      "status": "accepted",
      "score": 0.89,
      "tags": ["database", "migration"],
      "file_path": ".decisions/003-database-migration-strategy.md"
    }
  ]
}
```

## How It Works

### First Invocation

1. Scan `.decisions/` for markdown files
2. Parse YAML frontmatter (id, title, status, tags, date, deciders)
3. Generate embeddings with fastembed (local, CPU)
4. Store in embedded HelixDB (`~/.helix/data/adr/`)
5. Search and return ranked results

### Subsequent Invocations

1. Quick delta check (compare file hashes)
2. Re-index only changed/new ADRs
3. Remove deleted ADRs from index
4. Search existing index (~100ms)

## ADR Format

ADRs should be markdown files with YAML frontmatter:

```yaml
---
id: 3
title: Database Migration Strategy
status: accepted
date: 2026-01-04
deciders:
  - Alice
  - Bob
tags:
  - database
  - migration
---

# Context and Problem Statement
...

# Decision
...
```

### Status Values

| Status | Description |
|--------|-------------|
| `proposed` | Under discussion |
| `accepted` | Decision made and in effect |
| `superseded` | Replaced by another ADR |
| `deprecated` | No longer relevant |

## Agent Integration

Agents can invoke adr-search to build context:

```bash
# Get relevant decisions as JSON
adr-search "API versioning" --json | \
  jq '.results[] | "\(.id): \(.title)"'

# Output:
# 3: API Versioning Strategy
# 1: HTTP API Design
```

## Performance

| Operation | Time | Notes |
|-----------|------|-------|
| First search | 2-5s | One-time indexing |
| Subsequent search | < 100ms | Delta check + search |
| Query embedding | 50-100ms | fastembed (local) |
| HelixDB search | < 50ms | Vector similarity |

## Architecture

```
User/Agent
    │
    ↓
┌─────────────────────────────────┐
│   adr-search CLI                │
└──────────┬──────────────────────┘
           │
    ┌──────▼──────────────────────┐
    │ Embedded HelixDB             │
    │ • Vector index               │
    │ • Persistent (~/.helix/)     │
    └──────────────────────────────┘
```

## Not In This Tool

adr-search is focused on **search only**:

- ADR creation (agents use templates + $EDITOR)
- ADR editing (humans use $EDITOR)
- Format validation (CI concern)
- Git operations (users commit)
- Approval workflows (separate tool)

## See Also

- [ADR format guide](https://github.com/joelparkerhenderson/architecture_decision_record)
- [HelixDB](https://github.com/HelixDB/helix-db)
